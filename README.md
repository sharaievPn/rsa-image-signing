# RSA Image Signing with Randomized LSB Steganography

## Вступ
Цей проєкт демонструє, як за допомогою класичної криптографії RSA та стеганографії на основі Least Significant Bit (LSB) можна надійно захистити цілісність зображень і приховати цифровий підпис у файлі.

## Основні компоненти

1. **Генерація ключів** (`src/key_generator.py`)
   - Створюється 4096‑бітна пара RSA ключів (приватний + публічний).
2. **Цифровий підпис** (`src/sign_image.py`)
   - Обчислюється SHA‑256 хеш оригінального зображення.
   - Хеш підписується приватним ключем RSA‑PSS.
3. **LSB‑стеганографія з випадковим порядком** (`src/sign_image.py`)
   - Підпис конвертується в бітову послідовність.
   - Генерується список координат `(x, y, channel)` для кожного пікселя та каналу RGB.
   - З використанням секретного `seed` координати перемішуються, і біти вшиваються в LSB кожного каналу.
4. **Перевірка підпису** (`src/signature_checker.py`)
   - Із підписаного зображення за тим самим `seed` витягується бітова послідовність.
   - Обчислюється SHA‑256 хеш оригіналу та перевіряється підпис публічним ключем.

## Детальний підхід LSB
- **Ємність**: 3 біти на піксель (LSB у каналах R, G, B).
- **Відтворюваність**: порядок вшивання визначається за допомогою `random.seed(seed)`.
- **Стійкість**: без знання правильного `seed` вилучити чи змінити підпис практично неможливо.

## Структура репозиторію
```
individual_task/
├── src/
│   ├── key_generator.py         # Генерація RSA ключів
│   ├── sign_image.py            # Підписування та LSB вшивання
│   ├── signature_checker.py     # Витягнення та перевірка підпису
│   └── main.py                  # CLI для виконання всіх кроків
│
├── images/
│   ├── original_labrador.png    # Оригінальне зображення
│   └── encrypted_labrador.png   # Зображення з прихованим підписом
│
├── keys/
│   ├── private_key.pem          # Приватний ключ (згенер.)
│   └── public_key.pem           # Публічний ключ (згенер.)
│
├── data/
│   └── signature.bin            # Окремий бінарний файл підпису
│
├── requirements.txt             # Список залежностей
├── README.md                    # Цей файл
└── .gitignore                   # Ігнорування .venv, ключів, IDE-файлів
```

## Інструкція з використання

1. **Встановлення залежностей**:
   ```bash
   pip install -r requirements.txt
   ```
2. **Генерація ключів**:
   ```bash
   python src/key_generator.py --private keys/private_key.pem --public keys/public_key.pem
   ```
3. **Підпис та вшивання підпису**:
   ```bash
   python src/sign_image.py \
     images/original_labrador.png \
     images/encrypted_labrador.png \
     keys/private_key.pem \
     12345678
   ```
4. **Перевірка підпису**:
   ```bash
   python src/signature_checker.py \
     images/encrypted_labrador.png \
     images/original_labrador.png \
     keys/public_key.pem \
     12345678
   ```

## Залежності
```txt
cryptography>=3.4.7
pillow>=8.0.0
```

## Потенційне застосування
- Захист авторських прав на цифрові зображення.
- Приховане маркування контенту в безпечних каналах.
- Перевірка цілісності і походження ілюстрацій у документообігу.

## Подальший розвиток
- Адаптивний розподіл бітів за аналізом візуальної чутливості.
- Шифрування підпису перед стеганографією для багаторівневої безпеки.
- Веб-інтерфейс або API для автоматизації процесу.

